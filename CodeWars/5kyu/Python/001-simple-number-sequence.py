# https://www.codewars.com/kata/5a28cf591f7f7019a80000de
# In this Kata, you will be given a string of numbers in sequence and your task will be to return the missing number. If there is no number missing or there is an error in the sequence, return -1.
# For example:
# missing("123567") = 4
# missing("899091939495") = 92
# missing("9899101102") = 100
# missing("599600601602") = -1 -- no number missing
# missing("8990919395") = -1 -- error in sequence. Both 92 and 94 missing.


def missing(s):
    # assume that input contains at least 3 numbers
    length = len(s) // 3
    start = None

    # find the correct number length
    # gap between the next and previous number could be only 1 or 2 
    while length > 0:
        start = int(s[0:length])
        next = int(s[length:2 * length])
        nextLong = int(s[length:2 * length + 1])  # handle scenario 99 -> 100
        if next - start == 1 or nextLong - start == 1 or next - start == 2 or nextLong - start == 2:
            break
        else:
            length -= 1

    missing = []
    while len(s) > 0 and len(missing) < 2:
        find = str(start)
        
        if s.startswith(find, 0):
            s = s.replace(find,'', 1)
        else:
            missing.append(start)
        
        start += 1
    
    return missing[0] if len(missing) == 1 else -1


print(missing("123567"), 4)
print(missing("899091939495"), 92)
print(missing("9899101102"), 100)
print(missing("599600601602"), -1)
print(missing("8990919395"), -1)
print(missing("998999100010011003"), 1002)
print(missing("99100101102"), -1)
print(missing("979899100101102"), -1)
print(missing("900001900002900004900005900006"), 900003)
print(missing("211926211927211928211929211931211932211933211934211935211936211937211938211939"), 211930)
print(missing('645324645325645326645327645328645329645330645331645332645333645334645335'), -1)
print(missing('380630380632380633380634380635380636380637380638380639380640380641380642380643'), 380631)
print(missing('536178536179536180536181536182536183536184536185536187536188536189'), 536186)
print(missing('999299939995999699979998999910000100011000210003'), 9994)
print(missing('7264572646726477264872649726507265172652726537265472655'), -1)
print(missing('9939949959969979989991000100110021003'), -1)
print(missing('657906657907657908657909657910657911657912657913657914'), -1)
print(missing('9496979899100101102103'), 95)
print(missing('837725837726837728837729837730837731837732837733837734'), 837727)
print(missing('9495969798100101102103'), 99)
print(missing('439983439984439986439987439988439989439990439991439992'), 439985)
print(missing('999499959996999799989999100001000110002'), -1)
print(missing('123618123619123620123621123622123623123624123625123626'), -1)
print(missing('9994999599979998999910000100011000210003'), 9996)
print(missing('85188851898519085191851928519385194851958519685197851988519985200'), -1)
print(missing('999919999299993999949999599996999979999899999100000100001100002100003'), -1)
print(missing('898128898129898130898131898132898133898134898135898136898137'), -1)
print(missing('9949959969979989991000100110021003'), -1)
print(missing('592617592618592619592621592623592624592625592626'), -1)
print(missing('9999499995999979999899999100000100001100002100003'), 99996)
print(missing('556136556137556138556139556140556141556142556144556145556146556147556148'), 556143)
print(missing('991992993994995996998999100010011003'), -1)
print(missing('644219644220644221644223644224644225644226644227644228644229644230644231644232'), 644222)
print(missing('02345678910111213'), 1)
print(missing('967404967405967406967407967408967409967410967411967412967413'), -1)
print(missing('9949959969979989991000100110021003'), -1)
print(missing('570131570133570134570135570136570137570138570140570141570142'), -1)
print(missing('99992999939999499995999969999899999100000100001100002100003'), 99997)
print(missing('499706499707499709499710499711499712499713499714499715499716499717499718499719'), 499708)
print(missing('9990999199929993999499959996999799989999100001000210003'), 10001)
print(missing('584605584606584607584608584610584611584612584613584614584615584616'), 584609)
print(missing('999299949995999699979998999910000100011000210003'), 9993)
print(missing('97128971299713097131971329713397134971369713797138971399714097141'), 97135)
print(missing('99909992999399949995999699979998999910000100011000210003'), 9991)
print(missing('397285397286397287397288397289397290397291397293397294397295397296397297397298'), 397292)
print(missing('99909991999399949995999699979998999910000100011000210003'), 9992)
print(missing('827983827984827985827986827988827989827990827991827992827993827994827995827996'), 827987)
print(missing('01235678910111213'), 4)
print(missing('709135709136709137709138709139709140709141709142709143709144709145709146709147709148'), -1)
print(missing('012345678910111213'), -1)
print(missing('494962494963494964494965494966494968494969494970494971494972494973'), 494967)
print(missing('9929939949969979989991000100110021003'), 995)
print(missing('452233452234452235452236452237452238452239452240452241452242452243452244'), -1)
print(missing('2345678910111213'), -1)
print(missing('21320213212132221323213242132521326213272132921330'), 21328)
print(missing('993994995996998999100010011003'), -1)
print(missing('703874703875703876703877703878703879703880703881703882703883703884703885'), -1)
print(missing('9992999399949995999699979998999910000100011000210003'), -1)
print(missing('448767448768448769448770448772448773448774448775448776448777448778'), 448771)
print(missing('9999299993999949999599996999979999899999100000100002100003'), 100001)
print(missing('370713370715370716370717370718370719370720370721370722370723370724370725370726'), 370714)
print(missing('999909999199992999939999599996999979999899999100000100001100003'), -1)
print(missing('103034103035103036103037103038103040103041103042103043103044103045103046103047'), 103039)
print(missing('01234578910111213'), 6)
print(missing('969359969360969361969363969365969366969367969368969369'), -1)
print(missing('993994995996997998999100010021003'), 1001)
print(missing('767293767294767295767296767297767298767299767300767302767303767304767305767306'), 767301)
print(missing('99909991999399949995999699979998999910000100011000210003'), 9992)
print(missing('84123841248412584126841278412884129841308413184132841338413484135'), -1)
print(missing('9919929939949959969979989991000100110021003'), -1)
print(missing('151437151438151439151440151441151442151443151444151445151446151447151448151449'), -1)
print(missing('919293949596979899100101102103'), -1)
print(missing('291023291024291025291026291027291028291030291031291033'), -1)
print(missing('99939994999699979998999910000100011000210003'), 9995)
print(missing('475215475216475217475218475219475221475222475223475224475225475226'), 475220)
print(missing('9293949596979899101102103'), 100)
print(missing('600875600876600877600878600879600880600881600882600883600885600886'), 600884)
print(missing('99992999949999599996999979999899999100000100001100002100003'), 99993)
print(missing('300701300702300703300704300705300706300707300708300709300710300711300712'), -1)
print(missing('2345678910111213'), -1)
print(missing('751069751070751071751072751073751074751075751076751077751078751079'), -1)
print(missing('99993999949999599996999979999899999100000100001100002100003'), -1)
print(missing('435104435105435106435107435108435109435110435111435112435113435114435115435116'), -1)
print(missing('12345678910111213'), -1)
print(missing('598789598790598791598792598793598794598795598796598798598799598800598801'), 598797)
print(missing('9991999299949995999699979998999910000100011000210003'), 9993)
print(missing('789294789295789296789297789298789299789300789301789302789303789304789305789307'), 789306)
print(missing('999909999299993999949999599996999979999899999100000100001100002100003'), 99991)
print(missing('475865475866475867475868475869475870475871475872475873475874475875475876'), -1)
print(missing('999199929993999499959996999799989999100001000210003'), 10001)
print(missing('480325480326480327480328480329480330480331480332480333480334480335'), -1)
print(missing('999399949995999699979998999910000100011000210003'), -1)
print(missing('441462441463441464441465441466441467441468441469441470441471441472441473441474'), -1)
print(missing('12345678910111213'), -1)
print(missing('476161476162476163476164476166476167476168476169476170476171476172476173476174'), 476165)
print(missing('99909991999299939994999599969998999910000100011000210003'), 9997)
print(missing('765584765585765586765587765588765589765590765591765592765593765594'), -1)
print(missing('9939949959969979989991000100110021003'), -1)
print(missing('519359519360519361519362519363519364519365519366519367519368519369519370519371519372'), -1)
print(missing('012345678910111213'), -1)
print(missing('555545555546555547555548555549555550555552555553555554555555555556555557'), 555551)
print(missing('9999199992999949999599996999979999899999100000100001100002100003'), 99993)
print(missing('876184876185876186876187876188876189876190876192876193876194'), 876191)
print(missing('993994995996997998999100010021003'), 1001)
print(missing('181406181407181408181409181410181411181412181413181414181415181416181417'), -1)
print(missing('9999299993999949999599996999979999899999100000100001100002100003'), -1)
print(missing('278121278122278123278124278125278126278127278128278130278131278132278133'), 278129)
print(missing('9192939495969798100101102103'), 99)
print(missing('410567410568410569410570410571410572410573410574410575410576'), -1)